function wcMoipModalShow(a){a||(a=woocommerce_moip_params.processing),jQuery("#woocommerce-moip-modal").empty().append(a),jQuery("#woocommerce-moip-modal-wrap").show()}function wcMoipModalHide(){jQuery("#woocommerce-moip-modal-wrap").hide()}function wcMoipRedirectTimer(a){a>0&&jQuery("#redirect-timer").html(a)}var wcMoipSuccess=function(a){var b=jQuery("#woocommerce-moip-payment-form .panel:visible").data("payment-method"),c=jQuery("#woocommerce-moip-error"),d=10,e={action:"woocommerce_moip_transparent_checkout",security:woocommerce_moip_params.security,order_id:jQuery("#woocommerce-moip-order-id").val(),method:b};"CartaoCredito"===b?(e.code=a.CodigoMoIP,e.status=a.Status):e.url=a.url,jQuery.ajax({type:"POST",url:woocommerce_moip_params.ajax_url,cache:!1,data:e,success:function(){wcMoipModalHide(),"CartaoCredito"!==b&&window.open(a.url,"Moip","width=750, height=550, scrollbars=1"),wcMoipModalShow(woocommerce_moip_params.redirecting),setInterval(function(){wcMoipRedirectTimer(d--)},1e3),setTimeout(function(){window.location.href=jQuery("#woocommerce-moip-redirect").val()},1e4)},error:function(){c.empty(),c.prepend(woocommerce_moip_params.ajax_fail),c.show(),wcMoipModalHide()}})},wcMoipFail=function(a){var b=jQuery("#woocommerce-moip-error"),c=function(a){return!!a&&a.constructor===Object},d=[];c(a)&&(d.push(a),a=d),b.empty(),b.prepend('<ul style="margin: 0;"></ul>'),jQuery.each(a,function(a,c){jQuery("ul",b).prepend("<li>"+c.Mensagem+"</li>")}),b.show(),wcMoipModalHide()};jQuery(document).ready(function(a){a("body").append('<div id="woocommerce-moip-modal-wrap"><div id="woocommerce-moip-modal-bg"></div><div id="woocommerce-moip-modal"></div></div>');var b=a("#woocommerce-moip-submit");b.replaceWith('<button type="submit" class="button alt" id="woocommerce-moip-submit">'+b.text()+"</button>"),a("#woocommerce-moip-payment-form .product").fadeIn(),a(".woocommerce").prepend('<div id="woocommerce-moip-error" class="woocommerce-error" style="display: none;"></div>'),a(".woocommerce-tabs .panel").not(":eq(0)").hide(),a(".woocommerce-tabs .panel:eq(0)").show(),a(".woocommerce-tabs ul.tabs li a").on("click",function(b){b.preventDefault();var c=a(this),d=c.closest(".woocommerce-tabs");a("ul.tabs li",d).removeClass("active"),a("div.panel",d).hide(),a("div"+c.attr("href")).show(),c.parent().addClass("active")}),a('#woocommerce-moip-payment-form input[name="payment_institution"]').on("click",function(){var b=a("#woocommerce-moip-payment-form .panel:visible").data("payment-method"),c=a("#tab-credit-card .form-group-wrap"),d=a("#credit-card-installments");"CartaoCredito"===b&&(c.fadeOut(),c.fadeIn(),installmentsDisplay=function(b){0!==b.parcelas.length&&(d.empty(),a.each(b.parcelas,function(a,b){price=b.valor.replace(".",","),total=b.valor_total.replace(".",","),option="1"===b.quantidade?'<option value="'+b.quantidade+'">R$ '+price+" "+woocommerce_moip_params.at_sight+"</option>":'<option value="'+b.quantidade+'">'+b.quantidade+"x "+woocommerce_moip_params.of+" R$ "+price+" (R$ "+total+")</option>",d.append(option)}))},MoipUtil.calcularParcela({instituicao:a(this).val(),callback:"installmentsDisplay"}))}),a("#woocommerce-moip-payment-form").on("submit",function(b){b.preventDefault();var c=a("#woocommerce-moip-payment-form .panel:visible").data("payment-method"),d=a('#woocommerce-moip-payment-form input[name="payment_institution"]:checked').val(),e=jQuery("#woocommerce-moip-error"),f={};e.hide(),d?("CartaoCredito"===c?(f.Forma="CartaoCredito",f.Instituicao=d,f.Parcelas=a("#credit-card-installments").val(),f.CartaoCredito={Numero:a("#credit-card-number").val(),Expiracao:a("#credit-card-expiration-month").val()+"/"+a("#credit-card-expiration-year").val(),CodigoSeguranca:a("#credit-card-security-code").val(),Portador:{Nome:a("#credit-card-name").val().toUpperCase(),DataNascimento:a("#credit-card-birthdate-day").val()+"/"+a("#credit-card-birthdate-month").val()+"/"+a("#credit-card-birthdate-year").val(),Telefone:a("#credit-card-phone").val(),Identidade:a("#credit-card-cpf").val()}}):"DebitoBancario"===c?(f.Forma="DebitoBancario",f.Instituicao=d):f.Forma="BoletoBancario",wcMoipModalShow(),new MoipWidget(f)):(e.empty(),e.prepend(woocommerce_moip_params.method_empty),e.show())})});